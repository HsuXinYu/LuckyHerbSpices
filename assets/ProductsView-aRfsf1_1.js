import{a as _,s as U}from"./sweetalert.min-cx6vSVxL.js";import{M}from"./modal-2DPi5Yck.js";import{_ as g,o as i,c as a,a as t,f as c,v as u,J as $,F as b,h as P,g as p,d as k,t as m,K as x,r as v,b as f}from"./index-I6cWyZY8.js";const V={props:["event","product"],data(){return{tempProduct:{imagesUrl:[]}}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()},processEvent(){this.event==="post"?this.postProduct():this.event==="edit"&&this.editProduct()},postProduct(){const d=this.tempProduct;_.post("https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/product",{data:d}).then(l=>{alert(l.data.message),this.$emit("get-product"),this.hideModal()}).catch(()=>{})},addImage(){this.tempProduct.imageUrl&&this.tempProduct.imagesUrl.push(this.tempProduct.imageUrl)},removeImage(){this.tempProduct.imagesUrl!==0&&this.tempProduct.imagesUrl.pop()},editProduct(){const d=this.tempProduct.id,e={...this.tempProduct},l=`https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/product/${d}`;_.put(l,{data:e}).then(h=>{alert(h.data.message),this.$emit("get-product"),this.hideModal()}).catch(()=>{})}},watch:{product(d){this.tempProduct={...d}}},mounted(){this.modal=new M(this.$refs.productModal)}},I={id:"productModal",class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"productModalLabel","aria-hidden":"true",ref:"productModal"},D={class:"modal-dialog modal-xl"},G={class:"modal-content border-0"},B={class:"modal-header bg-dark text-white"},L=t("h5",{id:"productModalLabel",class:"modal-title"},null,-1),N={class:"modal-body"},E={class:"row"},T={class:"col-sm-4"},z={class:"mb-2"},F={class:"mb-3"},j=t("label",{for:"",class:"form-label"},"上傳圖片取得圖片網址",-1),A={class:"mb-3"},J=t("label",{for:"",class:"form-label"},"輸入圖片網址",-1),K=["src"],S=["src"],W={class:"col-sm-8"},q={class:"mb-3"},H=t("label",{for:"title",class:"form-label"},"標題",-1),O={class:"row"},Q={class:"mb-3 col-md-6"},R=t("label",{for:"category",class:"form-label"},"分類",-1),X={class:"mb-3 col-md-6"},Y=t("label",{for:"unit",class:"form-label"},"單位",-1),Z={class:"row"},tt={class:"mb-3 col-md-6"},et=t("label",{for:"origin_price",class:"form-label"},"原價",-1),ot={class:"mb-3 col-md-6"},st=t("label",{for:"price",class:"form-label"},"售價",-1),lt=t("hr",null,null,-1),dt={class:"mb-3"},nt=t("label",{for:"description",class:"form-label"},"產品描述",-1),it={class:"mb-3"},at=t("label",{for:"content",class:"form-label"},"說明內容",-1),rt=t("div",{class:"mb-3"},[t("div",{class:"form-check"},[t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0}),t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用")])],-1),ct={class:"modal-footer"};function ut(d,e,l,h,s,n){return i(),a("div",I,[t("div",D,[t("div",G,[t("div",B,[L,t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=o=>s.tempProduct={...l.product})})]),t("div",N,[t("div",E,[t("div",T,[t("div",z,[t("div",F,[j,t("input",{id:"file",type:"file",class:"form-control",placeholder:"請上傳圖片",onChange:e[1]||(e[1]=o=>d.uploadImage(o))},null,32)]),t("div",A,[J,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[2]||(e[2]=o=>s.tempProduct.imageUrl=o)},null,512),[[u,s.tempProduct.imageUrl]])]),s.tempProduct.imageUrl?(i(),a("img",{key:0,class:"img-fluid",src:s.tempProduct.imageUrl,alt:"主圖"},null,8,K)):$("",!0),(i(!0),a(b,null,P(s.tempProduct.imagesUrl,o=>(i(),a("img",{key:o,class:"img-fluid",src:o,alt:"次要圖"},null,8,S))),128))]),t("div",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=p((...o)=>n.addImage&&n.addImage(...o),["prevent"]))}," 新增圖片 ")]),t("div",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[4]||(e[4]=(...o)=>n.removeImage&&n.removeImage(...o))}," 刪除圖片 ")])]),t("div",W,[t("div",q,[H,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=o=>s.tempProduct.title=o)},null,512),[[u,s.tempProduct.title]])]),t("div",O,[t("div",Q,[R,c(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[6]||(e[6]=o=>s.tempProduct.category=o)},null,512),[[u,s.tempProduct.category]])]),t("div",X,[Y,c(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[7]||(e[7]=o=>s.tempProduct.unit=o)},null,512),[[u,s.tempProduct.unit]])])]),t("div",Z,[t("div",tt,[et,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[8]||(e[8]=o=>s.tempProduct.origin_price=o)},null,512),[[u,s.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",ot,[st,c(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[9]||(e[9]=o=>s.tempProduct.price=o)},null,512),[[u,s.tempProduct.price,void 0,{number:!0}]])])]),lt,t("div",dt,[nt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[10]||(e[10]=o=>s.tempProduct.description=o)},`
                `,512),[[u,s.tempProduct.description]])]),t("div",it,[at,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[11]||(e[11]=o=>s.tempProduct.content=o)},`
                `,512),[[u,s.tempProduct.content]])]),rt])])]),t("div",ct,[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:e[12]||(e[12]=o=>s.tempProduct={...l.product})}," 取消 "),t("button",{type:"button",class:"btn btn-primary",onClick:e[13]||(e[13]=p((...o)=>n.processEvent&&n.processEvent(...o),["prevent"]))}," 確認 ")])])])],512)}const pt=g(V,[["render",ut]]),mt={props:["event","product"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()},deleteProduct(){const e=`https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/product/${this.product.id}`;_.delete(e).then(l=>{alert(l.data.message),this.$emit("get-product"),this.hideModal()}).catch(()=>{})}},mounted(){this.modal=new M(this.$refs.delProductModal)}},ht={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},_t={class:"modal-dialog"},bt={class:"modal-content border-0"},gt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),vt={class:"modal-body"},ft={class:"text-danger"},Pt={class:"modal-footer"},yt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(d,e,l,h,s,n){return i(),a("div",ht,[t("div",_t,[t("div",bt,[gt,t("div",vt,[k(" 是否刪除 "),t("strong",ft,m(l.product.title),1),k(" 商品(刪除後將無法恢復)。 ")]),t("div",Pt,[yt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...o)=>n.deleteProduct&&n.deleteProduct(...o))}," 確認刪除 ")])])])],512)}const xt=g(mt,[["render",kt]]),Mt={props:["pagination"],data(){return{}},methods:{getProduct(d){this.$emit("get-product",d)}}},wt={class:"d-flex justify-content-center","aria-label":"Page navigation example"},Ct={class:"pagination"},Ut=["onClick"];function $t(d,e,l,h,s,n){return i(),a("nav",wt,[t("ul",Ct,[t("li",{class:x(["page-item",{disabled:l.pagination.current_page===1}])},[t("a",{class:"page-link",onClick:e[0]||(e[0]=p(o=>n.getProduct(l.pagination.current_page-1),["prevent"]))},"Previous")],2),(i(!0),a(b,null,P(l.pagination.total_pages,o=>(i(),a("li",{class:"page-item",key:o},[t("a",{class:"page-link",onClick:y=>n.getProduct(o)},m(o),9,Ut)]))),128)),t("li",{class:x(["page-item",{disabled:l.pagination.current_page===l.pagination.total_pages}])},[t("a",{class:"page-link",onClick:e[1]||(e[1]=p(o=>n.getProduct(l.pagination.current_page+1),["prevent"]))},"Next")],2)])])}const Vt=g(Mt,[["render",$t]]),It={data(){return{products:[],event:"",product:{},pagination:{}}},components:{PostProductModal:pt,DelProductModal:xt,PaginationComponent:Vt},methods:{getProduct(d=1){const e=`https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/products/?page=${d}`;_.get(e).then(l=>{this.pagination=l.data.pagination,this.products=l.data.products}).catch(()=>{U("","伺服器無法連線","warning",{timer:2e3})})},showModal(d,e){this.event=d,d==="post"?(this.product={},this.$refs.postmodal.openModal()):d==="edit"?(this.product=e,this.$refs.postmodal.openModal()):d==="del"&&(this.product=e,this.$refs.delmodal.openModal())}},mounted(){var e;const d=(e=document.cookie.split("; ").find(l=>l.startsWith("hexToken=")))==null?void 0:e.split("=")[1];_.defaults.headers.common.Authorization=d,this.getProduct()}},Dt={class:"text-end mt-4"},Gt={class:"table mt-4"},Bt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",null,"產品主圖"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Lt=["src"],Nt={class:"text-end"},Et={class:"text-end"},Tt={key:0,class:"text-success"},zt={key:1},Ft={class:"btn-group"},jt=["onClick"],At=["onClick"];function Jt(d,e,l,h,s,n){const o=v("PostProductModal"),y=v("DelProductModal"),w=v("PaginationComponent");return i(),a(b,null,[t("div",Dt,[t("button",{id:"postProductBtn",type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=p(r=>n.showModal("post"),["prevent"]))}," 建立新的產品 ")]),t("table",Gt,[Bt,t("tbody",null,[(i(!0),a(b,null,P(s.products,r=>(i(),a("tr",{key:r.id},[t("td",null,m(r.category),1),t("td",null,m(r.title),1),t("td",null,[t("img",{style:{width:"200px"},src:r.imageUrl,alt:"主圖"},null,8,Lt)]),t("td",Nt,m(r.origin_price),1),t("td",Et,m(r.price),1),t("td",null,[r.is_enabled?(i(),a("span",Tt,"啟用")):(i(),a("span",zt,"未啟用"))]),t("td",null,[t("div",Ft,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:p(C=>n.showModal("edit",r),["prevent"])}," 編輯 ",8,jt),t("button",{id:"showDelModalBtn",type:"button",class:"btn btn-outline-danger btn-sm",onClick:p(C=>n.showModal("del",r),["prevent"])}," 刪除 ",8,At)])])]))),128))])]),f(o,{ref:"postmodal",event:s.event,onGetProduct:n.getProduct,product:s.product},null,8,["event","onGetProduct","product"]),f(y,{ref:"delmodal",event:s.event,onGetProduct:n.getProduct,product:s.product},null,8,["event","onGetProduct","product"]),f(w,{pagination:s.pagination,onGetProduct:n.getProduct},null,8,["pagination","onGetProduct"])],64)}const qt=g(It,[["render",Jt]]);export{qt as default};
