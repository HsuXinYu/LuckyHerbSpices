import{a as _}from"./axios-G2rPRu76.js";import{M}from"./modal-2lUnOgc8.js";import{_ as g,o as i,c as a,a as t,e as c,v as u,J as U,F as b,g as P,f as p,d as k,t as m,K as x,r as v,b as f}from"./index-Z2iVc0QE.js";const $={props:["event","product"],data(){return{tempProduct:{imagesUrl:[]}}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()},processEvent(){this.event==="post"?this.postProduct():this.event==="edit"&&this.editProduct()},postProduct(){const d=this.tempProduct;_.post("https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/product",{data:d}).then(l=>{alert(l.data.message),this.$emit("get-product"),this.hideModal()}).catch(()=>{})},addImage(){this.tempProduct.imageUrl&&this.tempProduct.imagesUrl.push(this.tempProduct.imageUrl)},removeImage(){this.tempProduct.imagesUrl!==0&&this.tempProduct.imagesUrl.pop()},editProduct(){const d=this.tempProduct.id,e={...this.tempProduct},l=`https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/product/${d}`;_.put(l,{data:e}).then(h=>{alert(h.data.message),this.$emit("get-product"),this.hideModal()}).catch(()=>{})}},watch:{product(d){this.tempProduct={...d}}},mounted(){this.modal=new M(this.$refs.productModal)}},V={id:"productModal",class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"productModalLabel","aria-hidden":"true",ref:"productModal"},I={class:"modal-dialog modal-xl"},D={class:"modal-content border-0"},G={class:"modal-header bg-dark text-white"},B=t("h5",{id:"productModalLabel",class:"modal-title"},null,-1),L={class:"modal-body"},N={class:"row"},E={class:"col-sm-4"},T={class:"mb-2"},z={class:"mb-3"},F=t("label",{for:"",class:"form-label"},"上傳圖片取得圖片網址",-1),j={class:"mb-3"},A=t("label",{for:"",class:"form-label"},"輸入圖片網址",-1),J=["src"],K=["src"],S={class:"col-sm-8"},W={class:"mb-3"},q=t("label",{for:"title",class:"form-label"},"標題",-1),H={class:"row"},O={class:"mb-3 col-md-6"},Q=t("label",{for:"category",class:"form-label"},"分類",-1),R={class:"mb-3 col-md-6"},X=t("label",{for:"unit",class:"form-label"},"單位",-1),Y={class:"row"},Z={class:"mb-3 col-md-6"},tt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),et={class:"mb-3 col-md-6"},ot=t("label",{for:"price",class:"form-label"},"售價",-1),st=t("hr",null,null,-1),lt={class:"mb-3"},dt=t("label",{for:"description",class:"form-label"},"產品描述",-1),nt={class:"mb-3"},it=t("label",{for:"content",class:"form-label"},"說明內容",-1),at=t("div",{class:"mb-3"},[t("div",{class:"form-check"},[t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0}),t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用")])],-1),rt={class:"modal-footer"};function ct(d,e,l,h,s,n){return i(),a("div",V,[t("div",I,[t("div",D,[t("div",G,[B,t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:e[0]||(e[0]=o=>s.tempProduct={...l.product})})]),t("div",L,[t("div",N,[t("div",E,[t("div",T,[t("div",z,[F,t("input",{id:"file",type:"file",class:"form-control",placeholder:"請上傳圖片",onChange:e[1]||(e[1]=o=>d.uploadImage(o))},null,32)]),t("div",j,[A,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[2]||(e[2]=o=>s.tempProduct.imageUrl=o)},null,512),[[u,s.tempProduct.imageUrl]])]),s.tempProduct.imageUrl?(i(),a("img",{key:0,class:"img-fluid",src:s.tempProduct.imageUrl,alt:"主圖"},null,8,J)):U("",!0),(i(!0),a(b,null,P(s.tempProduct.imagesUrl,o=>(i(),a("img",{key:o,class:"img-fluid",src:o,alt:"次要圖"},null,8,K))),128))]),t("div",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=p((...o)=>n.addImage&&n.addImage(...o),["prevent"]))}," 新增圖片 ")]),t("div",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[4]||(e[4]=(...o)=>n.removeImage&&n.removeImage(...o))}," 刪除圖片 ")])]),t("div",S,[t("div",W,[q,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=o=>s.tempProduct.title=o)},null,512),[[u,s.tempProduct.title]])]),t("div",H,[t("div",O,[Q,c(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[6]||(e[6]=o=>s.tempProduct.category=o)},null,512),[[u,s.tempProduct.category]])]),t("div",R,[X,c(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[7]||(e[7]=o=>s.tempProduct.unit=o)},null,512),[[u,s.tempProduct.unit]])])]),t("div",Y,[t("div",Z,[tt,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[8]||(e[8]=o=>s.tempProduct.origin_price=o)},null,512),[[u,s.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",et,[ot,c(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[9]||(e[9]=o=>s.tempProduct.price=o)},null,512),[[u,s.tempProduct.price,void 0,{number:!0}]])])]),st,t("div",lt,[dt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[10]||(e[10]=o=>s.tempProduct.description=o)},`
                `,512),[[u,s.tempProduct.description]])]),t("div",nt,[it,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[11]||(e[11]=o=>s.tempProduct.content=o)},`
                `,512),[[u,s.tempProduct.content]])]),at])])]),t("div",rt,[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:e[12]||(e[12]=o=>s.tempProduct={...l.product})}," 取消 "),t("button",{type:"button",class:"btn btn-primary",onClick:e[13]||(e[13]=p((...o)=>n.processEvent&&n.processEvent(...o),["prevent"]))}," 確認 ")])])])],512)}const ut=g($,[["render",ct]]),pt={props:["event","product"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()},deleteProduct(){const e=`https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/product/${this.product.id}`;_.delete(e).then(l=>{alert(l.data.message),this.$emit("get-product"),this.hideModal()}).catch(()=>{})}},mounted(){this.modal=new M(this.$refs.delProductModal)}},mt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},ht={class:"modal-dialog"},_t={class:"modal-content border-0"},bt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),gt={class:"modal-body"},vt={class:"text-danger"},ft={class:"modal-footer"},Pt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function yt(d,e,l,h,s,n){return i(),a("div",mt,[t("div",ht,[t("div",_t,[bt,t("div",gt,[k(" 是否刪除 "),t("strong",vt,m(l.product.title),1),k(" 商品(刪除後將無法恢復)。 ")]),t("div",ft,[Pt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...o)=>n.deleteProduct&&n.deleteProduct(...o))}," 確認刪除 ")])])])],512)}const kt=g(pt,[["render",yt]]),xt={props:["pagination"],data(){return{}},methods:{getProduct(d){this.$emit("get-product",d)}}},Mt={class:"d-flex justify-content-center","aria-label":"Page navigation example"},wt={class:"pagination"},Ct=["onClick"];function Ut(d,e,l,h,s,n){return i(),a("nav",Mt,[t("ul",wt,[t("li",{class:x(["page-item",{disabled:l.pagination.current_page===1}])},[t("a",{class:"page-link",onClick:e[0]||(e[0]=p(o=>n.getProduct(l.pagination.current_page-1),["prevent"]))},"Previous")],2),(i(!0),a(b,null,P(l.pagination.total_pages,o=>(i(),a("li",{class:"page-item",key:o},[t("a",{class:"page-link",onClick:y=>n.getProduct(o)},m(o),9,Ct)]))),128)),t("li",{class:x(["page-item",{disabled:l.pagination.current_page===l.pagination.total_pages}])},[t("a",{class:"page-link",onClick:e[1]||(e[1]=p(o=>n.getProduct(l.pagination.current_page+1),["prevent"]))},"Next")],2)])])}const $t=g(xt,[["render",Ut]]),Vt={data(){return{products:[],event:"",product:{},pagination:{}}},components:{PostProductModal:ut,DelProductModal:kt,PaginationComponent:$t},methods:{getProduct(d=1){const e=`https://vue3-course-api.hexschool.io/v2/api/lucky_herb_spices/admin/products/?page=${d}`;_.get(e).then(l=>{this.pagination=l.data.pagination,this.products=l.data.products}).catch(l=>{alert(l.response.data.message)})},showModal(d,e){this.event=d,d==="post"?(this.product={},this.$refs.postmodal.openModal()):d==="edit"?(this.product=e,this.$refs.postmodal.openModal()):d==="del"&&(this.product=e,this.$refs.delmodal.openModal())}},mounted(){var e;const d=(e=document.cookie.split("; ").find(l=>l.startsWith("hexToken=")))==null?void 0:e.split("=")[1];_.defaults.headers.common.Authorization=d,this.getProduct()}},It={class:"text-end mt-4"},Dt={class:"table mt-4"},Gt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",null,"產品主圖"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Bt=["src"],Lt={class:"text-end"},Nt={class:"text-end"},Et={key:0,class:"text-success"},Tt={key:1},zt={class:"btn-group"},Ft=["onClick"],jt=["onClick"];function At(d,e,l,h,s,n){const o=v("PostProductModal"),y=v("DelProductModal"),w=v("PaginationComponent");return i(),a(b,null,[t("div",It,[t("button",{id:"postProductBtn",type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=p(r=>n.showModal("post"),["prevent"]))}," 建立新的產品 ")]),t("table",Dt,[Gt,t("tbody",null,[(i(!0),a(b,null,P(s.products,r=>(i(),a("tr",{key:r.id},[t("td",null,m(r.category),1),t("td",null,m(r.title),1),t("td",null,[t("img",{style:{width:"200px"},src:r.imageUrl,alt:"主圖"},null,8,Bt)]),t("td",Lt,m(r.origin_price),1),t("td",Nt,m(r.price),1),t("td",null,[r.is_enabled?(i(),a("span",Et,"啟用")):(i(),a("span",Tt,"未啟用"))]),t("td",null,[t("div",zt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:p(C=>n.showModal("edit",r),["prevent"])}," 編輯 ",8,Ft),t("button",{id:"showDelModalBtn",type:"button",class:"btn btn-outline-danger btn-sm",onClick:p(C=>n.showModal("del",r),["prevent"])}," 刪除 ",8,jt)])])]))),128))])]),f(o,{ref:"postmodal",event:s.event,onGetProduct:n.getProduct,product:s.product},null,8,["event","onGetProduct","product"]),f(y,{ref:"delmodal",event:s.event,onGetProduct:n.getProduct,product:s.product},null,8,["event","onGetProduct","product"]),f(w,{pagination:s.pagination,onGetProduct:n.getProduct},null,8,["pagination","onGetProduct"])],64)}const Wt=g(Vt,[["render",At]]);export{Wt as default};
